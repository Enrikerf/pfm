CREATE TABLE batches
(
    id         BIGINT       NOT NULL AUTO_INCREMENT,
    uuid       VARCHAR(255) NOT NULL UNIQUE,
    task_id    BIGINT       NOT NULL,
    task_uuid  VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (id),
    INDEX IDX_BATCHES_C_TASK_ID (task_id),
    CONSTRAINT FK_BATCHES_C_TASK_ID FOREIGN KEY (task_id) REFERENCES tasks (id)
);

ALTER TABLE results
    DROP INDEX IDX_RESULTS_C_TASK_ID,
    DROP FOREIGN KEY FK_RESULTS_C_TASK_ID,
    DROP COLUMN task_id,
    DROP COLUMN task_uuid,
    ADD COLUMN batch_id   BIGINT      NOT NULL,
    ADD COLUMN batch_uuid VARCHAR(255) NOT NULL,
    ADD INDEX IDX_RESULTS_C_BATCH_ID (batch_id),
    ADD CONSTRAINT FK_RESULTS_C_BATCH_ID FOREIGN KEY (batch_id) REFERENCES batches (id)
;